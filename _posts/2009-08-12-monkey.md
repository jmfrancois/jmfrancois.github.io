---
layout: post
title: Monkey ! When patching canâ€™t be merged
categories: en
tags: plone

---

Next to my first Plone patch that improved performance, I have been profiling the code on a simple query: get a javascript from portal_javascript already computed.

The result is clear: 28% of the time is spent in opaqueitems. So I have discussed about it on [CMF mailing list](http://mail.zope.org/pipermail/zope-cmf/2009-August/028559.html).

A monkey patch was already existing: [experimental.opaquespeedup](http://pypi.python.org/pypi/experimental.opaquespeedup). I have read the code. It replaces the time-consuming calls on all attributes by a catalog request. But I know that catalog can be slow if the website has lots of contents. I have decided to make something more aggressive, by just removing opaqueitems that seem to be not used.

So use it at your own risk!